# CEX 跨交易所套利监控系统使用指南

## 概述

本系统实现了一个全面的跨交易所套利监控功能，**以币安（Binance）为基准**，实时检测币安所有交易对在其他 6 个主要加密货币交易所的价格差异，并自动识别套利机会。

## 核心特性

### 币安基准策略

系统采用"以币安为基准"的策略：

1. **获取币安所有交易对** - 从币安获取所有活跃的 USDT 交易对作为监控基准
2. **检查其他交易所可用性** - 并行查询其他 6 个交易所，检测每个币安交易对在其他交易所是否可交易
3. **智能优先级排序** - 优先显示在更多交易所可交易的币种，提高套利可行性
4. **实时价格监控** - 对选定的交易对进行实时价格监控和套利机会识别

## 支持的交易所

系统支持以下 7 个主流加密货币交易所：

1. **币安 (Binance)** - 全球最大的加密货币交易所（基准交易所）
2. **OKX** - 领先的数字资产交易平台
3. **Gate.io** - 老牌交易所，支持多种交易对
4. **Bybit** - 专业的衍生品交易平台
5. **Bitget** - 快速增长的加密货币交易所
6. **火币 (Huobi)** - 全球知名交易平台
7. **MEXC** - 支持大量交易对的交易所

## 功能特性

### 1. 智能交易对选择（币安基准）

系统会自动：
- **获取币安所有交易对**：从币安交易所获取所有活跃的 USDT 交易对
- **并行查询其他交易所**：同时查询 OKX、Gate.io、Bybit、Bitget、火币、MEXC 的交易对列表
- **计算可用性**：统计每个币安交易对在其他交易所的可用情况
- **智能排序**：
  - 优先选择在多个交易所都可交易的币种（可用性高，套利可行性强）
  - 重点关注 40 种主流交易对（BTC、ETH、BNB、SOL、DOGE、MATIC、TRX、AVAX、LINK、ATOM 等）
  - 如果主流币种在至少 2 个交易所可交易，优先显示
  - 其他币种需要在至少 3 个交易所可交易才会显示
- **自动降级**：如果 API 访问受限，使用预设的 30-40 种热门交易对

### 2. 实时价格监控

- 并行获取每个交易对在 7 个交易所的实时价格
- 在表格中清晰展示所有价格数据
- 自动处理 API 请求失败的情况（显示 "-"）
- 5 秒超时保护，确保系统响应性

### 3. 价格差异计算

系统自动计算：
- **最高价格**: 在所有交易所中的最高报价
- **最低价格**: 在所有交易所中的最低报价
- **价格差**: 最高价与最低价的绝对差值
- **价格差百分比**: 相对于最低价的百分比差异

### 4. 套利机会识别

当价格差 > 0.5% 时，系统会：
- 标记为潜在套利机会
- 显示买入交易所（最低价）
- 显示卖出交易所（最高价）
- 用颜色标识重要程度（> 2% 为金色高优先级）

### 5. 自动刷新功能

用户可以配置：
- **刷新间隔**: 1秒、3秒、5秒、10秒、30秒、1分钟、5分钟、10分钟
- **开关控制**: 一键启用/禁用自动刷新
- **手动刷新**: 随时点击"刷新交易对"按钮
- **最后更新时间**: 显示数据最后更新的时间戳

## 使用说明

### 访问页面

1. 登录系统（使用 super 或 stx 角色账号）
2. 在导航菜单中点击 "CEX 套利监控"
3. 页面会自动加载并开始获取数据

### 查看数据

表格包含以下列：
- **交易对**: 如 BTCUSDT、ETHUSDT 等（币安基准）
  - 显示该交易对在多少个交易所可交易（例如：5/7 交易所）
- **币安**: 币安交易所的价格（基准价格）
- **OKX**: OKX 交易所的价格
- **Gate**: Gate.io 的价格
- **Bybit**: Bybit 的价格
- **Bitget**: Bitget 的价格
- **火币**: 火币的价格
- **MEXC**: MEXC 的价格
- **价差**: 最高价与最低价的差异（金额和百分比）
- **套利机会**: 当价差显著时显示买卖建议

### 配置自动刷新

1. 点击"自动刷新"开关启用自动刷新
2. 在下拉菜单中选择刷新间隔（建议 30 秒或更长）
3. 系统会按照设定的间隔自动更新数据

### 手动刷新

- 点击"刷新交易对"按钮可以重新获取交易对列表
- 表格会自动刷新价格数据

## 套利策略示例

### 基本套利流程

1. **识别机会**: 找到价差 > 0.5% 的交易对
2. **验证流动性**: 确保两个交易所都有足够的流动性
3. **计算成本**: 考虑交易手续费、提币费用、网络费用
4. **执行交易**: 
   - 在低价交易所买入
   - 转账到高价交易所
   - 在高价交易所卖出
5. **风险控制**: 设置止损点，控制仓位

### 注意事项

⚠️ **风险提示**:
- 价格变化快速，机会稍纵即逝
- 转账时间可能导致价差消失
- 手续费和提币费会影响实际收益
- 市场波动可能造成损失
- 某些交易对可能存在流动性不足的问题

💡 **最佳实践**:
- 优先选择流动性好的主流币种
- 计算总成本（交易费 + 提币费 + 滑点）
- 只在价差明显且持续时执行套利
- 保持多个交易所账户和资金准备
- 使用 API 自动化交易以提高速度

## 技术架构

### API 端点

系统使用各交易所的公开 API：

```
Binance: https://api.binance.com/api/v3
OKX: https://www.okx.com/api/v5
Gate.io: https://api.gateio.ws/api/v4
Bitget: https://api.bitget.com/api/v2
MEXC: https://api.mexc.com/api/v3
Huobi: https://api.huobi.pro
Bybit: https://api.bybit.com/v5
```

### 数据流程

```
用户界面
    ↓
获取币安交易对（基准） → [查询币安所有 USDT 交易对]
    ↓
检查其他交易所可用性 → [并行查询 6 个交易所的交易对列表]
    ↓
计算可用性并排序 → [统计每个币安交易对在几个交易所可用，按可用性排序]
    ↓
获取价格数据 → [并行查询选定交易对在所有交易所的实时价格]
    ↓
计算价差 → [找出最高价、最低价、计算差异百分比]
    ↓
识别套利机会 → [标记价差 > 0.5% 的交易对]
    ↓
显示结果 → [表格展示，显示交易所可用性，自动刷新]
```

### 性能优化

- **并行请求**: 所有 API 请求并行执行，提高响应速度
- **超时控制**: 每个请求 5 秒超时，避免长时间等待
- **错误处理**: 单个交易所失败不影响其他交易所数据
- **默认数据**: API 失败时使用默认交易对列表

## 故障排除

### 常见问题

**Q: 为什么某些交易所显示 "-"？**
A: 可能是网络问题、API 限流或该交易对在该交易所不存在。

**Q: 数据更新慢怎么办？**
A: 检查网络连接，或增加刷新间隔以减少 API 请求频率。

**Q: 发现套利机会但实际操作亏损？**
A: 需要仔细计算所有费用（交易费、提币费、网络费），并考虑价格滑点。

**Q: 可以增加更多交易所吗？**
A: 可以，只需在 `src/api/cex-arbitrage.ts` 中添加新交易所的 API 接口。

## 开发者信息

### 文件结构

```
src/
  api/
    cex-arbitrage.ts       # 交易所 API 接口
  components/
    CexArbitrageMonitor.tsx  # 监控组件
  views/
    CexArbitrage.tsx       # 页面视图
```

### 扩展功能

可以考虑添加：
- 套利机会历史记录
- 价格走势图表
- 邮件/推送通知
- 自动化交易接口
- 更多技术指标分析

## 许可证

本项目遵循 MIT 许可证。

---

**免责声明**: 本系统仅供学习和研究使用。加密货币交易存在高风险，请谨慎投资。开发者不对使用本系统造成的任何损失负责。
